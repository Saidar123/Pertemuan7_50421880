package com.mahasiswa.view;
 
import com.mahasiswa.model.modelTableMahasiswa;
import com.mahasiswa.model.modelMahasiswa;
import com.mahasiswa.controller.mahasiswaController;
import com.mahasiswa.model.hibernateUtil;
import java.util.List;
import javax.swing.*;
 
public class mahasiswaView extends javax.swing.JFrame {
    private mahasiswaController controller;
    
    public void loadMahasiswaTable(){
        List<modelMahasiswa> listMahasiswa = controller.getAllMahasiswa();
        
        modelTableMahasiswa tableModel = new modelTableMahasiswa(listMahasiswa);
        
        dataTable.setModel(tableModel);
    }
 
    public mahasiswaView() {
        initComponents();
        controller = new mahasiswaController();
        hibernateUtil.testConnection();
        loadMahasiswaTable();
    }
    
    public void clearTextField(){
        jTextField1.setText("");
        jTextField2.setText("");
        jTextField3.setText("");
        jTextField4.setText("");
    }
 
    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    
 
    /** ... */
 
 
    private void jButton1ActionPerformed(java.awt.event.ActionEvent evt) {                                         
        String npm = jTextField1.getText();
        String nama = jTextField2.getText();
        int semester = Integer.parseInt(jTextField3.getText());
        float ipk = Float.parseFloat(jTextField4.getText());
        modelMahasiswa mahasiswa = new modelMahasiswa(0, npm, nama, semester, ipk);
        System.out.println(mahasiswa.getIpk());
        System.out.println(mahasiswa.getNama());
        System.out.println(mahasiswa.getSemester());
        System.out.println(mahasiswa.getNpm());
        
        controller.addMhs(mahasiswa);
        loadMahasiswaTable();
        clearTextField();
    }                                        
 
    private void jButton2ActionPerformed(java.awt.event.ActionEvent evt) {                                         
        JTextField idField = new JTextField(5);
        
        JPanel panel = new JPanel();
        panel.add(new JLabel("Masukan ID yang ingin dihapus :"));
        panel.add(idField);
        
        int result = JOptionPane.showConfirmDialog(null, panel, "Hapus Mahasiswa", JOptionPane.OK_CANCEL_OPTION, JOptionPane.PLAIN_MESSAGE);
        
        if(result == JOptionPane.OK_OPTION){
            try{
                int id = Integer.parseInt(idField.getText());
                controller.deleteMhs(id);
                JOptionPane.showMessageDialog(null, "Data berhasil dihapus", "Sukses", JOptionPane.INFORMATION_MESSAGE);
                loadMahasiswaTable();
            }catch (NumberFormatException e){
                JOptionPane.showMessageDialog(null, "ID harus berupa angka", "Error", JOptionPane.ERROR_MESSAGE);
            }
        }
    }
 
    /** ... */